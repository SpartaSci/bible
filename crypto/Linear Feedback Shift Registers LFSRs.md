look in a hardware concept [[hardware/watermarking/LFSR - Linear Feedback Shift Register|LFSR]]



![](https://upload.wikimedia.org/wikipedia/commons/thumb/2/28/LFSR-F16.svg/351px-LFSR-F16.svg.png)
> [!note] Theorem
> The maximum period (or sequence length) generated by an LFSR of degree m is $2^m -1$

> [!note] Theorem
> Only certain Feedback configurations $(p_{m-1},...,p_0)$ yield maximum length sequences


Configurations parameters are the p that chose where place the xor (so no the internal value)


**notation**
$$p(x)=x^m+p_{m-1}x^{m-1} +...+p_1x+p_0$$

Only LFSRs with **primitive polynomials** yield maximum length sequences

**next bit formula**
$$s_{m+i} \equiv \sum^{m-1}_{j=0}s_{i+j}p_j \mod 2 ,\ i=0,1,2.. $$

# attack
Oscal goal get keystream
Oscar knows:
- all $y_i$
- degree $m$
- $x_0,...,x_{2m-1}$ (the first bit of a word file are fixed header)

1. $y_i = x_i \oplus  s_i$ -> $s_i = y_i \oplus x_i$ for first 2m i value
2. recover $2_{2m}, ...$

$s_m \equiv s_{m-1} p_{m-1}+...s_0p_0 \mod 2$ the unknowns are the p
Its a linea equation problem with m unknown



> [!danger] 
> if an attacker knows (at least) 2m output values of an LFSR he can recover the entire LFSR configuration

